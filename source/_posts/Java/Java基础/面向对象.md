---
title: 面向对象
date: 2023-12-14 16:59:22
tags: [Java基础, 面向对象]
categories: 面向对象
cover: https://gitee.com/zyjgyp/imgs/raw/master/imgs/Java基础-面向对象.webp
---

## static

### 概念

静态修饰符，可以修饰成员变量、成员方法。

### 实例变量和类变量的区别

#### 类变量

有 `static` 修饰，属于类，在计算机里只有一份，会被类和类的全部对象共享。

```Java
// User
public class User {
    // 类变量
    public static String school = "清华";
}

// Main
public class Main {
    public static void main(String[] args) {
        // 访问类变量
        System.out.println(User.school); // 清华
    }
}

```

#### 实例变量

无 `static` 修饰，属于每个对象的，只能通过对象访问。

```Java
// User
public class User {
    // 实例变量
    public int age;

    public String name;
}

// Main
public class Main {
    public static void main(String[] args) {
        // 访问实例变量
        User user1 = new User();
        user1.name = "ps";
        user1.age = 12;

        System.out.println(user1.name); // ps
        System.out.println(user1.age); // 12
    }
}
```

### 成员方法的分类

#### 类方法

有`static`修饰的成员方法，属于类。

```Java
// User
public class User {
    // 类变量
    public static String school = "清华";

    // 类方法
    public static void changeSchool(){
        school = "北大";
    }
}

// Main
public class Main {
    public static void main(String[] args) {
        // 访问类方法
        User.changeSchool();
        System.out.println(User.school); // 北大
    }
}
```

#### 实例方法

无 static 修饰的成员方法，属于对象。

```Java
// User
public class User {
    // 实例变量
    public int age;

    public String name;

    // 实例方法
    public void printName(){
        System.out.println(this.name);
    }

}

// Main
public class Main {
    public static void main(String[] args) {
        // 访问实例方法
        User user1 = new User();
        user1.name = "ps";
        user1.age = 12;
        user1.printName(); // ps
    }
}
```

#### 类方法的应用场景

类方法最常见的应用场景就是做工具类。（工具类中的方法就是一些类方法，每个方法都是用来完成一个功能的，工具类是给开发人员共同使用的。）

实现一个简单的工具类

```Java
// StringUtils
public class StringUtils {
    // 字符串反转
    public static String reverse(String str){
        if(str == null){
            return null;
        }
        return new StringBuilder(str).reverse().toString();
    }
}

// Main
public class Main {
    public static void main(String[] args) {
        System.out.println(StringUtils.reverse("String")); // gnirtS
    }
}
```

#### 为什么工具类要用类方法，不用实例方法

1. 实例方法需要创建对象来调用，此时对象只是为了调用方法，对象占内存，这样会浪费内存。
2. 类方法，直接调用类名即可，调用方便也节省内存。

> 工具类没有创建对象的需求，可以将工具类的构造器加上`private`修饰符进行私有化。

### 代码块

代码块是类的 5 大成分之一（成员变量、构造器、方法、`代码块`、内部类）。

#### 静态代码块

- 格式：static {}
- 特点：类加载时自动执行，由于类只会加载一次，所以静态代码块也只会执行一次。
- 作用：完成类的初始化，例如：对类变量的初始化赋值。

```Java
// Block
public class Block {
    public static String name = "ps";
    static {
        System.out.println("静态代码块执行了");
    }
}

// Main
public class Main {
    public static void main(String[] args) {
        System.out.println(Block.name);
        // 静态代码块执行了
        // ps
    }
}
```

#### 实例代码块

- 格式：{}
- 特点：每次创建对象时，执行实例代码块，并在构造器前执行。
- 作用：和构造器一样，都是用来完成对象初始化的，例如：对实例变量进行初始化赋值。

```Java
// Block
public class Block {
    {
        System.out.println("实例代码块执行了");
        this.name = "ps";
        System.out.println(this.name);
    }
    public String name;
    Block(){
        System.out.println("无参构造执行");
    }
    Block(String name){
        System.out.println("有参构造执行");
    }
}

// Main
public class Main {
    public static void main(String[] args) {
        Block block = new Block();
        block.name = "ps2";
        System.out.println(block.name);

        // 实例代码块执行了
        // ps
        // 无参构造执行
        // ps2
    }
}

```

### 单例设计模式

#### 概念

单例设计模式是一种创建型设计模式，主要目的是确保一个类只有一个实例。

#### 实现步骤

1. 把类的构造器私有化，防止外部直接实例化。
2. 定义一个类变量记住类的一个对象。
3. 定义一个类方法，返回对象。

- 饿汉单例
  饿汉式单例是在类加载的时候就会创建实例。它保证了线程安全，但可能在应用启动时就会创建实例，可能会浪费一些资源。

```Java
// Single
public class Single {
    // 2. 定义一个变量记住类的对象
    private static Single single = new Single();
    // 1. 私有类构造器
    private Single(){}
    // 3. 定义一个类方法返回类的对象
    public static Single getObject(){
        return single;
    }
}

// Main
public class Main {
    public static void main(String[] args) {
        Single single1 = Single.getObject();
        Single single2 = Single.getObject();
        System.out.println(single1 == single2); // true
    }
}
```

- 懒汉单例

懒汉单例是在需要时才创建实例。如果实例已经存在，则返回现有实例。

```Java
// SingletonLazy
public class SingletonLazy {
    // 1. 将类的构造函数私有化
    private SingletonLazy(){}
    // 2. 定义一个变量用于存储对象
    private static SingletonLazy singletonLazy;
    // 3. 返回对象
    public static SingletonLazy getInstance(){
        if(singletonLazy == null){
            singletonLazy = new SingletonLazy();
        }
        return singletonLazy;
    }
}


// Main
public class Main {
    public static void main(String[] args) {
        SingletonLazy singletonLazy1 = SingletonLazy.getInstance();
        SingletonLazy singletonLazy2 = SingletonLazy.getInstance();
        System.out.println(singletonLazy1 == singletonLazy2); // true
    }
}
```
